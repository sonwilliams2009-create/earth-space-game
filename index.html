// Load students from localStorage
let students = JSON.parse(localStorage.getItem("students")) || {};

// Save students to localStorage
function saveStudents(){
  localStorage.setItem("students", JSON.stringify(students));
}

// When adding a student:
document.getElementById("addStudentBtn").onclick=function(){
  const name=document.getElementById("newStudentName").value.trim();
  if(!name) return alert("Enter a name!");
  if(students[name]) return alert("Student already exists!");
  let allowedUnits={}, scores={total:0};
  for(let term in terms){ allowedUnits[term]={}; terms[term].forEach(u=> allowedUnits[term][u]=true);}
  students[name]={allowedUnits,scores};
  saveStudents(); // save immediately
  document.getElementById("newStudentName").value="";
  populateStudentDropdown(); loadLeaderboard(); alert(`Student ${name} added! ðŸŽ‰`);
}

// When logging in:
document.getElementById("studentLoginBtn").onclick=function(){
  students = JSON.parse(localStorage.getItem("students")) || {}; // refresh
  const name=document.getElementById("studentName").value.trim();
  if(!name) return alert("Enter username!");
  if(!students[name]) return alert("Student not found ðŸ˜­");
  currentStudent=name; show("studentMenu"); buildTermButtons();
}
