<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Earth & Space Science Game</title>
<style>
body{margin:0;font-family:Arial;background:radial-gradient(circle at center,#000010,#000000);color:white;text-align:center;}
.screen{display:none;padding:40px;}
.active{display:block;}
button,input{padding:10px;margin:10px;border-radius:8px;border:none;}
button{background:#ff9800;cursor:pointer;}
button:hover{background:white;color:black;}
.card{background:rgba(0,0,0,0.85);padding:20px;border-radius:15px;max-width:650px;margin:auto;}
.answer{display:block;margin:10px auto;width:80%;padding:10px;background:#111;color:white;border:1px solid orange;}
.answer:hover{background:orange;color:black;}
table{margin:auto;background:black;padding:10px;}
</style>
</head>
<body>

<!-- PUBLIC LOGIN -->
<div id="login" class="screen active">
<h1>üåçüåå Earth & Space Science Game</h1>
<h2>Enter Your Nickname</h2>
<input id="playerName" placeholder="Nickname">
<button onclick="startGame()">Start Playing</button>
<p><small>Teachers can log in with a hidden login (hint: press Shift+T)</small></p>
</div>

<!-- TEACHER LOGIN -->
<div id="teacherLogin" class="screen">
<h2>Teacher Login</h2>
<input id="teacherPass" type="password" placeholder="Password">
<button onclick="teacherLogin()">Login</button>
<button onclick="show('login')">Back</button>
</div>

<!-- MODULE SELECTION -->
<div id="moduleScreen" class="screen">
<h1>üß≠ Choose a Module</h1>
<div id="stageButtons"></div>
<button onclick="showLeaderboard()">View Leaderboard</button>
</div>

<!-- GAME -->
<div id="game" class="screen">
<div class="card">
<h2 id="stageTitle"></h2>
<p id="question"></p>
<div id="answers"></div>
<p>‚≠ê Score: <span id="score">0</span></p>
</div>
</div>

<!-- LEADERBOARD -->
<div id="leaderboard" class="screen">
<h1>üèÜ Leaderboard</h1>
<div id="board"></div>
<button onclick="goHome()">Home</button>
<button id="resetScoresBtn" style="display:none;" onclick="resetLeaderboard()">Reset Scores (Teacher)</button>
</div>

<script>
// --- SETTINGS ---
let currentPlayer="";
let score=0;
let currentStage=null;
let currentQuestionIndex=0;
let isTeacher=false;
const teacherPassword="caves"; // hidden password

// --- MODULES (same as before, abbreviated) ---
const stages = {
stage1:{title:"üí• Big Bang & Universe", questions:[
{q:"The Big Bang theory explains the origin of?", a:[{text:"The universe",correct:true},{text:"Earth",correct:false},{text:"Sun",correct:false}]},
{q:"The Cosmic Microwave Background is?", a:[{text:"Radiation from early universe",correct:true},{text:"A type of star",correct:false},{text:"Planetary dust",correct:false}]}
]},
stage2:{title:"üåû Earth-Sun-Moon System", questions:[
{q:"What causes seasons?", a:[{text:"Earth tilt and orbit",correct:true},{text:"Sun spots",correct:false},{text:"Moon phases",correct:false}]}
]},
// (other stages same as before, you can expand)
};

// --- STORAGE ---
let progress = JSON.parse(localStorage.getItem("progress")) || {};
let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || {};

// --- UI FUNCTIONS ---
function show(id){document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));document.getElementById(id).classList.add("active");}

// --- PUBLIC LOGIN ---
function startGame(){
currentPlayer=document.getElementById("playerName").value.trim();
if(!currentPlayer){alert("Enter a nickname");return;}
isTeacher=false;
loadModules();
}

function loadModules(){
let div=document.getElementById("stageButtons"); div.innerHTML="";
for(let i in stages){
let btn=document.createElement("button");
btn.innerText=stages[i].title;
btn.onclick=()=>startStage(i);
div.appendChild(btn);
}
show("moduleScreen");
}

// --- GAME LOGIC ---
function startStage(key){
currentStage=stages[key];
currentQuestionIndex=(progress[currentPlayer]&&progress[currentPlayer][key])||0;
score=0;
show("game");
showQuestion();
}

function showQuestion(){
let q=currentStage.questions[currentQuestionIndex];
document.getElementById("stageTitle").innerText=currentStage.title;
document.getElementById("question").innerText=q.q;
let div=document.getElementById("answers"); div.innerHTML="";
q.a.forEach(a=>{
let btn=document.createElement("button");
btn.className="answer"; btn.innerText=a.text;
btn.onclick=()=>checkAnswer(a.correct);
div.appendChild(btn);
});
}

function checkAnswer(correct){
if(correct)score+=20;
currentQuestionIndex++;
saveProgress();
if(currentQuestionIndex<currentStage.questions.length){
showQuestion();
}else{
saveScore();
alert("Module Complete! Score: "+score);
showLeaderboard();
}
}

function saveProgress(){
if(!progress[currentPlayer]) progress[currentPlayer]={};
for(let k in stages){if(stages[k]===currentStage){progress[currentPlayer][k]=currentQuestionIndex;}}
localStorage.setItem("progress",JSON.stringify(progress));
}

function saveScore(){
if(!leaderboard[currentPlayer]) leaderboard[currentPlayer]=0;
leaderboard[currentPlayer]+=score;
localStorage.setItem("leaderboard",JSON.stringify(leaderboard));
}

// --- LEADERBOARD ---
function showLeaderboard(){
let html="<table><tr><th>Name</th><th>Score</th></tr>";
for(let p in leaderboard){html+="<tr><td>"+p+"</td><td>"+leaderboard[p]+"</td></tr>";}
html+="</table>";
document.getElementById("board").innerHTML=html;
document.getElementById("resetScoresBtn").style.display=isTeacher?"inline-block":"none";
show("leaderboard");
}

function goHome(){show("login");}

function resetLeaderboard(){leaderboard={};localStorage.setItem("leaderboard",JSON.stringify(leaderboard));showLeaderboard();}

// --- TEACHER LOGIN ---
document.addEventListener("keydown",e=>{
if(e.shiftKey && e.key.toLowerCase()=="t"){show("teacherLogin");}
});

function teacherLogin(){
let pass=document.getElementById("teacherPass").value;
if(pass===teacherPassword){isTeacher=true;alert("Teacher logged in!");showLeaderboard();}
else alert("Wrong password");
}
</script>
</body>
</html>
